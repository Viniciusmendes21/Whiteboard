{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class CanvasService {\n  constructor() {\n    this.elementsSubject = new BehaviorSubject([]);\n    this.zoomSubject = new BehaviorSubject(1);\n    this.panSubject = new BehaviorSubject({\n      x: 0,\n      y: 0\n    });\n    this.elements$ = this.elementsSubject.asObservable();\n    this.zoom$ = this.zoomSubject.asObservable();\n    this.pan$ = this.panSubject.asObservable();\n  }\n  get elements() {\n    return this.elementsSubject.value;\n  }\n  get zoom() {\n    return this.zoomSubject.value;\n  }\n  get pan() {\n    return this.panSubject.value;\n  }\n  addElement(element) {\n    const elements = [...this.elements, element];\n    this.elementsSubject.next(elements);\n  }\n  updateElement(id, updates) {\n    const elements = this.elements.map(el => el.id === id ? {\n      ...el,\n      ...updates\n    } : el);\n    this.elementsSubject.next(elements);\n  }\n  deleteElement(id) {\n    const elements = this.elements.filter(el => el.id !== id);\n    this.elementsSubject.next(elements);\n  }\n  deleteSelectedElements() {\n    const elements = this.elements.filter(el => !el.isSelected);\n    this.elementsSubject.next(elements);\n  }\n  clearSelection() {\n    const elements = this.elements.map(el => ({\n      ...el,\n      isSelected: false\n    }));\n    this.elementsSubject.next(elements);\n  }\n  selectElement(id, addToSelection = false) {\n    const elements = this.elements.map(el => ({\n      ...el,\n      isSelected: el.id === id ? true : addToSelection ? el.isSelected : false\n    }));\n    this.elementsSubject.next(elements);\n  }\n  setZoom(zoom) {\n    this.zoomSubject.next(Math.max(0.1, Math.min(5, zoom)));\n  }\n  setPan(pan) {\n    this.panSubject.next(pan);\n  }\n  clear() {\n    this.elementsSubject.next([]);\n    this.zoomSubject.next(1);\n    this.panSubject.next({\n      x: 0,\n      y: 0\n    });\n  }\n  getState() {\n    return {\n      elements: [...this.elements],\n      zoom: this.zoom,\n      panX: this.pan.x,\n      panY: this.pan.y\n    };\n  }\n  setState(state) {\n    this.elementsSubject.next([...state.elements]);\n    this.zoomSubject.next(state.zoom);\n    this.panSubject.next({\n      x: state.panX,\n      y: state.panY\n    });\n  }\n  exportToJSON() {\n    return JSON.stringify(this.getState(), null, 2);\n  }\n  importFromJSON(json) {\n    try {\n      const state = JSON.parse(json);\n      this.setState(state);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n  generateId() {\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n  static {\n    this.ɵfac = function CanvasService_Factory(t) {\n      return new (t || CanvasService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: CanvasService,\n      factory: CanvasService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","CanvasService","constructor","elementsSubject","zoomSubject","panSubject","x","y","elements$","asObservable","zoom$","pan$","elements","value","zoom","pan","addElement","element","next","updateElement","id","updates","map","el","deleteElement","filter","deleteSelectedElements","isSelected","clearSelection","selectElement","addToSelection","setZoom","Math","max","min","setPan","clear","getState","panX","panY","setState","state","exportToJSON","JSON","stringify","importFromJSON","json","parse","generateId","Date","now","random","toString","substr","factory","ɵfac","providedIn"],"sources":["C:\\Users\\vinic\\Desktop\\Estagio\\Teste\\src\\app\\services\\canvas.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { CanvasState, DrawingElement, Point } from '../models/drawing.model';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CanvasService {\r\n  private elementsSubject = new BehaviorSubject<DrawingElement[]>([]);\r\n  private zoomSubject = new BehaviorSubject<number>(1);\r\n  private panSubject = new BehaviorSubject<Point>({ x: 0, y: 0 });\r\n\r\n  elements$: Observable<DrawingElement[]> = this.elementsSubject.asObservable();\r\n  zoom$: Observable<number> = this.zoomSubject.asObservable();\r\n  pan$: Observable<Point> = this.panSubject.asObservable();\r\n\r\n  get elements(): DrawingElement[] {\r\n    return this.elementsSubject.value;\r\n  }\r\n\r\n  get zoom(): number {\r\n    return this.zoomSubject.value;\r\n  }\r\n\r\n  get pan(): Point {\r\n    return this.panSubject.value;\r\n  }\r\n\r\n  addElement(element: DrawingElement): void {\r\n    const elements = [...this.elements, element];\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  updateElement(id: string, updates: Partial<DrawingElement>): void {\r\n    const elements = this.elements.map(el =>\r\n      el.id === id ? { ...el, ...updates } : el\r\n    );\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  deleteElement(id: string): void {\r\n    const elements = this.elements.filter(el => el.id !== id);\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  deleteSelectedElements(): void {\r\n    const elements = this.elements.filter(el => !el.isSelected);\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  clearSelection(): void {\r\n    const elements = this.elements.map(el => ({ ...el, isSelected: false }));\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  selectElement(id: string, addToSelection = false): void {\r\n    const elements = this.elements.map(el => ({\r\n      ...el,\r\n      isSelected: el.id === id ? true : (addToSelection ? el.isSelected : false)\r\n    }));\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  setZoom(zoom: number): void {\r\n    this.zoomSubject.next(Math.max(0.1, Math.min(5, zoom)));\r\n  }\r\n\r\n  setPan(pan: Point): void {\r\n    this.panSubject.next(pan);\r\n  }\r\n\r\n  clear(): void {\r\n    this.elementsSubject.next([]);\r\n    this.zoomSubject.next(1);\r\n    this.panSubject.next({ x: 0, y: 0 });\r\n  }\r\n\r\n  getState(): CanvasState {\r\n    return {\r\n      elements: [...this.elements],\r\n      zoom: this.zoom,\r\n      panX: this.pan.x,\r\n      panY: this.pan.y\r\n    };\r\n  }\r\n\r\n  setState(state: CanvasState): void {\r\n    this.elementsSubject.next([...state.elements]);\r\n    this.zoomSubject.next(state.zoom);\r\n    this.panSubject.next({ x: state.panX, y: state.panY });\r\n  }\r\n\r\n  exportToJSON(): string {\r\n    return JSON.stringify(this.getState(), null, 2);\r\n  }\r\n\r\n  importFromJSON(json: string): boolean {\r\n    try {\r\n      const state = JSON.parse(json);\r\n      this.setState(state);\r\n      return true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  generateId(): string {\r\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}