{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class CanvasService {\n  constructor() {\n    this.elementsSubject = new BehaviorSubject([]);\n    this.zoomSubject = new BehaviorSubject(1);\n    this.panSubject = new BehaviorSubject({\n      x: 0,\n      y: 0\n    });\n    this.snapToGridSubject = new BehaviorSubject(false);\n    this.gridSizeSubject = new BehaviorSubject(20);\n    this.elements$ = this.elementsSubject.asObservable();\n    this.zoom$ = this.zoomSubject.asObservable();\n    this.pan$ = this.panSubject.asObservable();\n    this.snapToGrid$ = this.snapToGridSubject.asObservable();\n    this.gridSize$ = this.gridSizeSubject.asObservable();\n  }\n  get elements() {\n    return this.elementsSubject.value;\n  }\n  get zoom() {\n    return this.zoomSubject.value;\n  }\n  get pan() {\n    return this.panSubject.value;\n  }\n  get snapToGrid() {\n    return this.snapToGridSubject.value;\n  }\n  get gridSize() {\n    return this.gridSizeSubject.value;\n  }\n  addElement(element) {\n    const elements = [...this.elements, element];\n    this.elementsSubject.next(elements);\n  }\n  updateElement(id, updates) {\n    const elements = this.elements.map(el => el.id === id ? {\n      ...el,\n      ...updates\n    } : el);\n    this.elementsSubject.next(elements);\n  }\n  deleteElement(id) {\n    const elements = this.elements.filter(el => el.id !== id);\n    this.elementsSubject.next(elements);\n  }\n  deleteSelectedElements() {\n    const elements = this.elements.filter(el => !el.isSelected);\n    this.elementsSubject.next(elements);\n  }\n  clearSelection() {\n    const elements = this.elements.map(el => ({\n      ...el,\n      isSelected: false\n    }));\n    this.elementsSubject.next(elements);\n  }\n  selectElement(id, addToSelection = false) {\n    const elements = this.elements.map(el => ({\n      ...el,\n      isSelected: el.id === id ? true : addToSelection ? el.isSelected : false\n    }));\n    this.elementsSubject.next(elements);\n  }\n  setZoom(zoom) {\n    this.zoomSubject.next(Math.max(0.1, Math.min(5, zoom)));\n  }\n  setPan(pan) {\n    this.panSubject.next(pan);\n  }\n  setSnapToGrid(enabled) {\n    this.snapToGridSubject.next(enabled);\n  }\n  setGridSize(size) {\n    const clamped = Math.max(5, Math.min(200, size));\n    this.gridSizeSubject.next(clamped);\n  }\n  clear() {\n    this.elementsSubject.next([]);\n    this.zoomSubject.next(1);\n    this.panSubject.next({\n      x: 0,\n      y: 0\n    });\n    this.snapToGridSubject.next(false);\n    this.gridSizeSubject.next(20);\n  }\n  getState() {\n    return {\n      elements: [...this.elements],\n      zoom: this.zoom,\n      panX: this.pan.x,\n      panY: this.pan.y,\n      snapToGrid: this.snapToGrid,\n      gridSize: this.gridSize\n    };\n  }\n  setState(state) {\n    this.elementsSubject.next([...state.elements]);\n    this.zoomSubject.next(state.zoom);\n    this.panSubject.next({\n      x: state.panX,\n      y: state.panY\n    });\n    this.snapToGridSubject.next(!!state.snapToGrid);\n    this.gridSizeSubject.next(state.gridSize ?? 20);\n  }\n  exportToJSON() {\n    return JSON.stringify(this.getState(), null, 2);\n  }\n  importFromJSON(json) {\n    try {\n      const state = JSON.parse(json);\n      this.setState(state);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n  generateId() {\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n  static {\n    this.ɵfac = function CanvasService_Factory(t) {\n      return new (t || CanvasService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: CanvasService,\n      factory: CanvasService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","CanvasService","constructor","elementsSubject","zoomSubject","panSubject","x","y","snapToGridSubject","gridSizeSubject","elements$","asObservable","zoom$","pan$","snapToGrid$","gridSize$","elements","value","zoom","pan","snapToGrid","gridSize","addElement","element","next","updateElement","id","updates","map","el","deleteElement","filter","deleteSelectedElements","isSelected","clearSelection","selectElement","addToSelection","setZoom","Math","max","min","setPan","setSnapToGrid","enabled","setGridSize","size","clamped","clear","getState","panX","panY","setState","state","exportToJSON","JSON","stringify","importFromJSON","json","parse","generateId","Date","now","random","toString","substr","factory","ɵfac","providedIn"],"sources":["C:\\Users\\vinic\\Desktop\\Estagio\\Teste\\src\\app\\services\\canvas.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { CanvasState, DrawingElement, Point } from '../models/drawing.model';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CanvasService {\r\n  private elementsSubject = new BehaviorSubject<DrawingElement[]>([]);\r\n  private zoomSubject = new BehaviorSubject<number>(1);\r\n  private panSubject = new BehaviorSubject<Point>({ x: 0, y: 0 });\r\n  private snapToGridSubject = new BehaviorSubject<boolean>(false);\r\n  private gridSizeSubject = new BehaviorSubject<number>(20);\r\n\r\n  elements$: Observable<DrawingElement[]> = this.elementsSubject.asObservable();\r\n  zoom$: Observable<number> = this.zoomSubject.asObservable();\r\n  pan$: Observable<Point> = this.panSubject.asObservable();\r\n  snapToGrid$: Observable<boolean> = this.snapToGridSubject.asObservable();\r\n  gridSize$: Observable<number> = this.gridSizeSubject.asObservable();\r\n\r\n  get elements(): DrawingElement[] {\r\n    return this.elementsSubject.value;\r\n  }\r\n\r\n  get zoom(): number {\r\n    return this.zoomSubject.value;\r\n  }\r\n\r\n  get pan(): Point {\r\n    return this.panSubject.value;\r\n  }\r\n\r\n  get snapToGrid(): boolean {\r\n    return this.snapToGridSubject.value;\r\n  }\r\n\r\n  get gridSize(): number {\r\n    return this.gridSizeSubject.value;\r\n  }\r\n\r\n  addElement(element: DrawingElement): void {\r\n    const elements = [...this.elements, element];\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  updateElement(id: string, updates: Partial<DrawingElement>): void {\r\n    const elements = this.elements.map(el =>\r\n      el.id === id ? { ...el, ...updates } : el\r\n    );\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  deleteElement(id: string): void {\r\n    const elements = this.elements.filter(el => el.id !== id);\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  deleteSelectedElements(): void {\r\n    const elements = this.elements.filter(el => !el.isSelected);\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  clearSelection(): void {\r\n    const elements = this.elements.map(el => ({ ...el, isSelected: false }));\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  selectElement(id: string, addToSelection = false): void {\r\n    const elements = this.elements.map(el => ({\r\n      ...el,\r\n      isSelected: el.id === id ? true : (addToSelection ? el.isSelected : false)\r\n    }));\r\n    this.elementsSubject.next(elements);\r\n  }\r\n\r\n  setZoom(zoom: number): void {\r\n    this.zoomSubject.next(Math.max(0.1, Math.min(5, zoom)));\r\n  }\r\n\r\n  setPan(pan: Point): void {\r\n    this.panSubject.next(pan);\r\n  }\r\n\r\n  setSnapToGrid(enabled: boolean): void {\r\n    this.snapToGridSubject.next(enabled);\r\n  }\r\n\r\n  setGridSize(size: number): void {\r\n    const clamped = Math.max(5, Math.min(200, size));\r\n    this.gridSizeSubject.next(clamped);\r\n  }\r\n\r\n  clear(): void {\r\n    this.elementsSubject.next([]);\r\n    this.zoomSubject.next(1);\r\n    this.panSubject.next({ x: 0, y: 0 });\r\n    this.snapToGridSubject.next(false);\r\n    this.gridSizeSubject.next(20);\r\n  }\r\n\r\n  getState(): CanvasState {\r\n    return {\r\n      elements: [...this.elements],\r\n      zoom: this.zoom,\r\n      panX: this.pan.x,\r\n      panY: this.pan.y,\r\n      snapToGrid: this.snapToGrid,\r\n      gridSize: this.gridSize\r\n    };\r\n  }\r\n\r\n  setState(state: CanvasState): void {\r\n    this.elementsSubject.next([...state.elements]);\r\n    this.zoomSubject.next(state.zoom);\r\n    this.panSubject.next({ x: state.panX, y: state.panY });\r\n    this.snapToGridSubject.next(!!state.snapToGrid);\r\n    this.gridSizeSubject.next(state.gridSize ?? 20);\r\n  }\r\n\r\n  exportToJSON(): string {\r\n    return JSON.stringify(this.getState(), null, 2);\r\n  }\r\n\r\n  importFromJSON(json: string): boolean {\r\n    try {\r\n      const state = JSON.parse(json);\r\n      this.setState(state);\r\n      return true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  generateId(): string {\r\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}